ssh pi4801 "curl -sfL https://get.k3s.io | INSTALL_K3S_VERSION=v1.19.1+k3s1 sh -s - server --token secret --write-kubeconfig-mode=644"
ssh pi4802 "curl -sfL https://get.k3s.io | INSTALL_K3S_VERSION=v1.19.1+k3s1 sh -s - agent  --token secret --server https://pi4801:6443"
ssh pi4803 "curl -sfL https://get.k3s.io | INSTALL_K3S_VERSION=v1.19.1+k3s1 sh -s - agent  --token secret --server https://pi4801:6443"
ssh pi4804 "curl -sfL https://get.k3s.io | INSTALL_K3S_VERSION=v1.19.1+k3s1 sh -s - agent  --token secret --server https://pi4801:6443"
ssh pi4805 "curl -sfL https://get.k3s.io | INSTALL_K3S_VERSION=v1.19.1+k3s1 sh -s - agent  --token secret --server https://pi4801:6443"
ssh pi4806 "curl -sfL https://get.k3s.io | INSTALL_K3S_VERSION=v1.19.1+k3s1 sh -s - agent  --token secret --server https://pi4801:6443"
ssh pi4807 "curl -sfL https://get.k3s.io | INSTALL_K3S_VERSION=v1.19.1+k3s1 sh -s - agent  --token secret --server https://pi4801:6443"
ssh pi4808 "curl -sfL https://get.k3s.io | INSTALL_K3S_VERSION=v1.19.1+k3s1 sh -s - agent  --token secret --server https://pi4801:6443"
ssh pi4809 "curl -sfL https://get.k3s.io | INSTALL_K3S_VERSION=v1.19.1+k3s1 sh -s - agent  --token secret --server https://pi4801:6443"
ssh pi4810 "curl -sfL https://get.k3s.io | INSTALL_K3S_VERSION=v1.19.1+k3s1 sh -s - agent  --token secret --server https://pi4801:6443"
ssh pi4811 "curl -sfL https://get.k3s.io | INSTALL_K3S_VERSION=v1.19.1+k3s1 sh -s - agent  --token secret --server https://pi4801:6443"
ssh pi4812 "curl -sfL https://get.k3s.io | INSTALL_K3S_VERSION=v1.19.1+k3s1 sh -s - agent  --token secret --server https://pi4801:6443"
ssh pi4813 "curl -sfL https://get.k3s.io | INSTALL_K3S_VERSION=v1.19.1+k3s1 sh -s - agent  --token secret --server https://pi4801:6443"
ssh pi4814 "curl -sfL https://get.k3s.io | INSTALL_K3S_VERSION=v1.19.1+k3s1 sh -s - agent  --token secret --server https://pi4801:6443"
ssh pi4815 "curl -sfL https://get.k3s.io | INSTALL_K3S_VERSION=v1.19.1+k3s1 sh -s - agent  --token secret --server https://pi4801:6443"
ssh pi4816 "curl -sfL https://get.k3s.io | INSTALL_K3S_VERSION=v1.19.1+k3s1 sh -s - agent  --token secret --server https://pi4801:6443"
ssh pi4817 "curl -sfL https://get.k3s.io | INSTALL_K3S_VERSION=v1.19.1+k3s1 sh -s - agent  --token secret --server https://pi4801:6443"
ssh pi4818 "curl -sfL https://get.k3s.io | INSTALL_K3S_VERSION=v1.19.1+k3s1 sh -s - agent  --token secret --server https://pi4801:6443"
ssh pi4819 "curl -sfL https://get.k3s.io | INSTALL_K3S_VERSION=v1.19.1+k3s1 sh -s - agent  --token secret --server https://pi4801:6443"
ssh pi4820 "curl -sfL https://get.k3s.io | INSTALL_K3S_VERSION=v1.19.1+k3s1 sh -s - agent  --token secret --server https://pi4801:6443"
ssh pi4821 "curl -sfL https://get.k3s.io | INSTALL_K3S_VERSION=v1.19.1+k3s1 sh -s - agent  --token secret --server https://pi4801:6443"
ssh pi4801 "curl https://raw.githubusercontent.com/helm/helm/master/scripts/get-helm-3 | bash"
ssh pi4801 "helm repo add stable https://charts.helm.sh/stable"
ssh pi4801 "helm repo add rancher-stable https://releases.rancher.com/server-charts/stable"
ssh pi4801 "helm repo add jetstack https://charts.jetstack.io"
ssh pi4801 "helm repo update"
ssh pi4801 "kubectl --kubeconfig /etc/rancher/k3s/k3s.yaml create namespace cattle-system"
ssh pi4801 "kubectl --kubeconfig /etc/rancher/k3s/k3s.yaml apply --validate=false -f https://github.com/jetstack/cert-manager/releases/download/v1.1.1/cert-manager.crds.yaml"
ssh pi4801 "kubectl --kubeconfig /etc/rancher/k3s/k3s.yaml create namespace cert-manager"
ssh pi4801 "export KUBECONFIG=/etc/rancher/k3s/k3s.yaml; helm install cert-manager jetstack/cert-manager --namespace cert-manager --version v1.1.1"
sleep 300
ssh pi4801 "export KUBECONFIG=/etc/rancher/k3s/k3s.yaml; helm install rancher rancher-stable/rancher --namespace cattle-system --set hostname=pi4801"

